<!DOCTYPE html>
<html><head>

<link rel="stylesheet" href="https://anyicomplex.github.io/css/code-highlight.css">


  <title>Ultimate Trimming for C/C&#43;&#43; Programs Size</title>





<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="This article represents only my personal view, welcome to leave a message to discuss">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Ultimate Trimming for C/C&#43;&#43; Programs Size" />
<meta property="og:description" content="This article represents only my personal view, welcome to leave a message to discuss" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anyicomplex.github.io/en/posts/ultimate-trimming-for-c-cpp-programs-size/" />
<meta property="article:published_time" content="2022-02-28T15:45:19-05:00" />
<meta property="article:modified_time" content="2022-03-06T23:09:04-05:00" /><meta property="og:site_name" content="anyicomplex&#39;s Blog" />





<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ultimate Trimming for C/C&#43;&#43; Programs Size"/>
<meta name="twitter:description" content="This article represents only my personal view, welcome to leave a message to discuss"/>







<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  




<link rel="icon" href="https://github.com/fluidicon.png">



<link rel="stylesheet" href="https://anyicomplex.github.io/scss/journal.min.f4a8de07567a2d29619e0711662ef6251e3e59b642079f99490f654abf89a3c4.css" integrity="sha256-9KjeB1Z6LSlhngcRZi72JR4&#43;WbZCB5&#43;ZSQ9lSr&#43;Jo8Q=" media="screen">



<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="/vendor/js/md5.min.js"></script>
<script>
  var gitalk = new Gitalk({
  clientID: 'ecaa9e60860d0402573e',
  clientSecret: 'e2a72d4628c46b1d35bdeef27db30f692f731c01',
  repo: 'anyicomplex.github.io',
  owner: 'anyicomplex',
  admin: ['anyicomplex'],
  id: md5(location.pathname),
  distractionFreeMode: 'false'
  });
  window.onload = function () {
        gitalk.render('gitalk-container')
  }
</script>












</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://anyicomplex.github.io/en/">
    
        <div class="nav-title">
            anyicomplex&#39;s Blog
        </div>
        
        <div class="nav-subtitle">
            Programming and Life | Miscellaneous Essays
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/en/posts">
                Archives
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/en/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/en/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/en/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Powered by <a href='https://gohugo.io/'>Hugo</a> with theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>' s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal</a> <br>
<br>


	
	2021 - 2022 © anyicomplex
	
        <br>
        
        
        All original blog posts on this site are under the <a href='https://creativecommons.org/licenses/by-nc/4.0/'>CC-BY-NC 4.0</a> License
	
	
    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#causes" onclick="onNavClick(`#causes-nav`)" id="causes-nav">
									Causes
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#methods" onclick="onNavClick(`#methods-nav`)" id="methods-nav">
									Methods
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-dynamically-runtime-calls" onclick="onNavClick(`#1-dynamically-runtime-calls-nav`)" id="1-dynamically-runtime-calls-nav">
									1. Dynamically runtime calls
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#nix" onclick="onNavClick(`#nix-nav`)" id="nix-nav">
									*nix
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows" onclick="onNavClick(`#windows-nav`)" id="windows-nav">
									Windows
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#2-adjusting-compiler-parameters" onclick="onNavClick(`#2-adjusting-compiler-parameters-nav`)" id="2-adjusting-compiler-parameters-nav">
									2. Adjusting compiler parameters
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-use-compression-shells" onclick="onNavClick(`#3-use-compression-shells-nav`)" id="3-use-compression-shells-nav">
									3. Use compression shells
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#thoughts" onclick="onNavClick(`#thoughts-nav`)" id="thoughts-nav">
									Thoughts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/en/posts">
                    Archives
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/en/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- CATALOG -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#causes" onclick="onNavClick(`#causes-nav`)" id="causes-nav">
									Causes
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#methods" onclick="onNavClick(`#methods-nav`)" id="methods-nav">
									Methods
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#1-dynamically-runtime-calls" onclick="onNavClick(`#1-dynamically-runtime-calls-nav`)" id="1-dynamically-runtime-calls-nav">
									1. Dynamically runtime calls
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#nix" onclick="onNavClick(`#nix-nav`)" id="nix-nav">
									*nix
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#windows" onclick="onNavClick(`#windows-nav`)" id="windows-nav">
									Windows
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#2-adjusting-compiler-parameters" onclick="onNavClick(`#2-adjusting-compiler-parameters-nav`)" id="2-adjusting-compiler-parameters-nav">
									2. Adjusting compiler parameters
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#3-use-compression-shells" onclick="onNavClick(`#3-use-compression-shells-nav`)" id="3-use-compression-shells-nav">
									3. Use compression shells
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#thoughts" onclick="onNavClick(`#thoughts-nav`)" id="thoughts-nav">
									Thoughts
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://anyicomplex.github.io/en/">
            anyicomplex&#39;s Blog
        </a>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://anyicomplex.github.io/en/">
        <div class="single-column-header-title">anyicomplex&#39;s Blog</div>
        
        <div class="single-column-header-subtitle">Programming and Life | Miscellaneous Essays</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            

            <div class="post-head-wrapper-text-only"
                
            >
                <div class="post-title">
                    Ultimate Trimming for C/C&#43;&#43; Programs Size
                    
                    <div class="post-subtitle">
                        This article represents only my personal view, welcome to leave a message to discuss
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-02-28 15:45
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/en/categories/it">IT</a>
                                &nbsp;
                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/en/tags/c">C</a>
                                &nbsp;
                            
                                <a href="/en/tags/c&#43;&#43;">C&#43;&#43;</a>
                                &nbsp;
                            
                        
                        
                            <i class="material-icons" style="">schedule</i>
                            

                            
                            

                            
                            2 min
                            
                            19 s.
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h1 id="causes">Causes</h1>
<p>Program release has always been a major problem for programmers, especially in the distribution of applets.<br>
If you wrote a small program with limited functionality, but it depends on a heavy runtime in dozens of megabytes, I believe that many users will not think it&rsquo;s worth to use.</p>
<p><strong>If you refute me with reasons like &ldquo;hard disks are now at a cabbage price&rdquo; or &ldquo;network bandwidth is worthless now that we&rsquo;re in the 5G era&rdquo;, then please close this blog post immediately because it&rsquo;s not written for you.</strong></p>
<h1 id="methods">Methods</h1>
<h2 id="1-dynamically-runtime-calls">1. Dynamically runtime calls</h2>
<p>As long as the target device contains the runtime and dependent libraries required by the program, it can be reduced in size by dynamically calling.</p>
<h3 id="nix">*nix</h3>
<p>This is not a problem on the *nix platform, because it must contain the available C/C++ runtime, and it is modular in terms of libraries, so you only need to specify the corresponding dependencies if you use the package manager, otherwise you have to install them manually.<br>
If you don&rsquo;t want to bother the user and don&rsquo;t use a package manager, then you have to reduce the dependencies and use only the libraries that are necessarily included in the target platform.</p>
<h3 id="windows">Windows</h3>
<p>Windows is not modular in terms of libraries, except for some basic C/C++ runtime libraries, so there is only one way to reduce dependencies.<br>
However, if you want to be compatible with older systems, the number of libraries that must be included is extremely limited, and even some of the basic C/C++ runtime libraries are not always included, so you either have to bother the user or use older runtime libraries.</p>
<ol>
<li>Use Visual C++ 6.0<br>
C/C++ programs compiled with VC6.0 only requires one runtime library, msvcrt.dll, which has been included in the system since Windows 2000.</li>
<li>Use the msvcrt version of MinGW and do not use C++ functions that are not supported by msvcrt<br>
If you don&rsquo;t want to use a compiler like VC6.0, which has been out of maintenance for years, and you want to ensure compatibility and trim size, then using the msvcrt version of MinGW and not using C++ features that are not supported by msvcrt is a good solution.<br>
In this case, the msvcrt version of MinGW compiles the same C/C++ program as VC6.0, with only requires msvcrt.dll as runtime library.</li>
</ol>
<h2 id="2-adjusting-compiler-parameters">2. Adjusting compiler parameters</h2>
<p>I don&rsquo;t think I need to say much about this. Specifying the compiler to optimize the code and not inserting debug informations is a basic skill.</p>
<h2 id="3-use-compression-shells">3. Use compression shells</h2>
<p>Compression shells such as UPX, ASPack, etc. can compress the size of the program, but they take up extra memory (because you have to decompress the compressed program into memory) and slow down the startup time (though not too much).<br>
My advice for this method is: do only if you need.</p>
<h1 id="thoughts">Thoughts</h1>
<p>After thinking about it, it&rsquo;s really not necessary to be so stingy now&hellip;These days, applets under 5M are basically within the acceptable range of users, while uncompressed executables of 20M&hellip;30M executables can be generally compressed to 5M or less.</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">Last modified on 2022-03-06</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://anyicomplex.github.io/en/posts/week-summary-20220227/">
			Next<br>Week Summary 20220227
                </a>
                
                
                
                <a class="older-posts" href="https://anyicomplex.github.io/en/posts/writing-and-compiling-win32-programs-under-linux/">
			Previous<br>Writing and Compiling win32 Programs under Linux
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                


<div id="gitalk-container"></div>









            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Powered by <a href='https://gohugo.io/'>Hugo</a> with theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
Ported from <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>' s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal</a> <br>
<br>


	
	2021 - 2022 © anyicomplex
	
        <br>
        
        
        All original blog posts on this site are under the <a href='https://creativecommons.org/licenses/by-nc/4.0/'>CC-BY-NC 4.0</a> License
	
	</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
